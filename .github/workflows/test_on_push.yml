name: Run CI check on push

on: push

jobs:
  run_ci:
    name: Run CI
    uses: tbricks/itiviti-cpp-analyzer/.github/workflows/build_and_test.yml@main
    with:
      build_type: 'Debug'
      branch: ${{ github.ref_name }}
  build_artifact:
    name: Prepare artifact
    needs: run_ci
    uses: tbricks/itiviti-cpp-analyzer/.github/workflows/build_and_test.yml@main
    with:
      build_type: 'RelWithDebInfo'
      branch: ${{ github.ref_name }}
      build_dir: artifact_build
      publish_artifact: true
